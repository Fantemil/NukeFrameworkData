import os 
import time
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.chrome.service import Service
# going to current dir
os.chdir(os.path.dirname(os.path.realpath(__file__)))
def clr():
    if os.name == 'nt':
        os.system('cls')
    else:
        os.system('clear')
def exitrun():
    os.chdir("..")
    print("Returning to NukeFramework...")
    time.sleep(1)
    clr()
    os.system("python3 run.py")
    exit()


clr()
print("===========================================================================")
print("Welcome to Nukenewsletter (A more Extreme email spammer)")
print("===========================================================================")
Email = input("\nEnter your Target Email Address (or type exit if you want to return to nf1): ")
if Email == "exit":
    exitrun()
while not "@" in Email:
    print("\nInvalid Email Address")
    time.sleep(1)
    Email = input("\nEnter your Target Email Address (or type exit if you want to return to nf1): ")
    if Email == "exit":
        print("Returning to NukeFramework...")
        time.sleep(1)
        clr()
        os.system("python3 run.py")
        exit()
number = input("\nEnter the number of emails you want to send (or type exit if you want to return to nf1): ")
if number == "exit":
    print("Returning to NukeFramework...")
    time.sleep(1)
    clr()
    os.system("python3 run.py")
    exit()
number = int(number)

done = 0
chrome_options = Options()
s = Service("/Applications/chromedriver")
#chrome_options.headless = True
driver = webdriver.Chrome(service=s, options=chrome_options)
if number >= 1:
    driver.get("https://www.dgb.de/service/newsletter/")
    time.sleep(3)
    # locate all accept cookies button //*[@id="cmpwelcomebtnyes"]/a :
    accept_cookies = driver.find_element(By.XPATH, '/html/body/div[1]//div[1]/div[1]/div[2]/span[3]/a')
    # click
    accept_cookies.click()
    time.sleep(1)
    # get the email input box by xpath //*[@id="555a9a3e-ecb9-11e3-bee2-52540023ef1a_elainenewsletter.email"]
    email = driver.find_element(By.XPATH,'//*[@id="555a9a3e-ecb9-11e3-bee2-52540023ef1a_elainenewsletter.email"]')
    # click the email input box
    email.click()
    # send the email to the input box
    email.send_keys(Email)
    # get the label //*[@id="main_slot"]/div[1]/form/fieldset/div[2]/div/div/div/div[1]/label
    label = driver.find_element(By.XPATH,'//*[@id="main_slot"]/div[1]/form/fieldset/div[2]/div/div/div/div[1]/label')
    # click
    label.click()
    # get element //*[@id="main_slot"]/div[1]/form/fieldset/div[3]/div/div/div/label as confirm
    confirm = driver.find_element(By.XPATH,'//*[@id="main_slot"]/div[1]/form/fieldset/div[3]/div/div/div/label')
    # get the button //*[@id="555a9a3e-ecb9-11e3-bee2-52540023ef1a_elainenewsletter.actions.subscribe"]
    button = driver.find_element(By.XPATH,'//*[@id="555a9a3e-ecb9-11e3-bee2-52540023ef1a_elainenewsletter.actions.subscribe"]')
    # click the button
    button.click()
    time.sleep(5)
    
    
    

    